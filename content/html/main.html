<!DOCTYPE html>
<html lang = "en">
<div id="bg-main"></div>
<head>
	<title>Solidity Mutation</title>
	<link rel="stylesheet" type="text/css" href="../css/main.css">
</head>


<body>
	<h1>Solidity Mutation</h1>

	<div id = "fileDiv">
	<form>
		<div class="slct">
			<span><label>Solidity Project</label></span>
			<span><label for="mutDir" class ="btn">Select Directory</label></span>
			<input type="file" id="mutDir" style="visibility:hidden" webkitdirectory multiple onchange="listFiles(document.getElementById('mutDir').files[0].path);">
		</div>

		<div class="slct">
		
		<script src="../js/main.js"></script>

		<script> listFiles(document.getElementById("mutDir").files[0].path); </script>
		<select size="5" id='display-files'>
		
		</select>
		</div>


		<label for = "run" class = "btn" id = "runBtn">Run</label>
		<button id="run" type="submit" value="Run" style="visibility:hidden">Run Tests</button>

		<label for = "generate" class="btn" id="genBtn">Generate</label>
		<button id="generate" type="submit" value = "Generate" style="visibility:hidden">Generate</button>
	</form>

	</div>

	<script>
		const electron = require('electron');
		const {ipcRenderer} = electron;

		//const form = document.querySelector('form');
		//form.addEventListener('submit', submitForm);

		const run = document.getElementById("run");
		run.addEventListener("click", runTests);

		const gen = document.getElementById("generate");
		gen.addEventListener("click", submitForm);

		function submitForm(e){
			e.preventDefault();
			const mutDirectory = document.getElementById('mutDir').files[0].path;
			const fileEle = document.getElementById('display-files')
			const mutFile = fileEle.options[fileEle.selectedIndex].value;
			const mutFileName = fileEle.options[fileEle.selectedIndex].getAttribute("name");

			var mutParam = [mutFile, mutDirectory, mutFileName]

			// Sending back to the applicaiton
			ipcRenderer.send('file:select', mutParam);
		}

		function runTests(e){
			const mutDirectory = document.getElementById('mutDir').files[0].path;
			const fileEle = document.getElementById('display-files');
			const mutFileName = fileEle.options[fileEle.selectedIndex].getAttribute("name");

			var mutParam = [mutDirectory, mutFileName];
			ipcRenderer.send('run:tests', mutParam);
		}
	</script>

</body>
</html>
